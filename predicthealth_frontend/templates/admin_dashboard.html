<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">

  <!-- Navbar -->
  <nav class="bg-indigo-600 text-white px-6 py-4 flex justify-between items-center shadow">
    <div class="flex items-center space-x-2">
      <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Logo" class="h-8 w-8">
      <span class="font-semibold text-lg">Admin Dashboard</span>
    </div>
    <!-- =============================================================== -->
    <!-- ESTA ES LA SECCIÓN MODIFICADA -->
    <!-- =============================================================== -->
    <div class="flex items-center space-x-4">
      <span class="font-semibold">Bienvenido, {{ name }}</span>
      <a href="{{ url_for('logout') }}" class="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100">
        Log Out
      </a>
    </div>
    <!-- =============================================================== -->
    <!-- FIN DE LA SECCIÓN MODIFICADA -->
    <!-- =============================================================== -->
  </nav>

  <!-- Main -->
  <main class="flex-1 p-6 grid grid-cols-12 gap-6">

    <!-- KPIs -->
    <div class="col-span-12 md:col-span-4 bg-white shadow rounded-xl p-6">
      <h2 class="text-gray-500 text-sm font-medium">Usuarios activos</h2>
      <p class="text-2xl font-semibold text-gray-800">1,245</p>
      <p class="text-green-500 text-sm">+5% este mes</p>
    </div>
    <div class="col-span-12 md:col-span-4 bg-white shadow rounded-xl p-6">
      <h2 class="text-gray-500 text-sm font-medium">Sistemas conectados</h2>
      <p class="text-2xl font-semibold text-gray-800">87</p>
      <p class="text-green-500 text-sm">+2 nuevos</p>
    </div>
    <div class="col-span-12 md:col-span-4 bg-white shadow rounded-xl p-6">
      <h2 class="text-gray-500 text-sm font-medium">Alertas críticas</h2>
      <p class="text-2xl font-semibold text-gray-800">12</p>
      <p class="text-red-500 text-sm">+3 esta semana</p>
    </div>

    <!-- Chart -->
    <div class="col-span-12 lg:col-span-8 bg-white rounded-xl shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Actividad de usuarios</h2>
      <canvas id="userActivityChart"></canvas>
    </div>

    <!-- Insights (IA) -->
    <div class="col-span-12 lg:col-span-4">
      <div class="bg-white rounded-xl shadow p-6">
        <h2 class="text-xl font-semibold mb-3">Insights</h2>
        <p class="text-gray-700">
          Aquí aparecerán insights generados por IA (ej: anomalías detectadas, recomendaciones de seguridad, predicciones).
        </p>
      </div>
    </div>

    <!-- Tabla -->
    <div class="col-span-12 bg-white rounded-xl shadow p-6 overflow-x-auto">
      <h2 class="text-xl font-semibold mb-4">Usuarios recientes</h2>
      <table class="w-full text-left border-collapse">
        <thead>
          <tr>
            <th class="border-b p-3">Usuario</th>
            <th class="border-b p-3">Correo</th>
            <th class="border-b p-3">Rol</th>
            <th class="border-b p-3">Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="p-3">Ana López</td>
            <td class="p-3">ana@example.com</td>
            <td class="p-3">Admin</td>
            <td class="p-3 text-green-600">Activo</td>
          </tr>
          <tr>
            <td class="p-3">Carlos Pérez</td>
            <td class="p-3">carlos@example.com</td>
            <td class="p-3">User</td>
            <td class="p-3 text-yellow-600">Pendiente</td>
          </tr>
          <tr>
            <td class="p-3">Laura Sánchez</td>
            <td class="p-3">laura@example.com</td>
            <td class="p-3">User</td>
            <td class="p-3 text-red-600">Suspendido</td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-100 text-gray-600 text-center py-4 mt-auto">
    © 2025 PredictHealth - Panel de Administración
  </footer>

  <!-- Chart Script -->
  <script>
    const ctx = document.getElementById('userActivityChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul'],
        datasets: [{
          label: 'Usuarios activos',
          data: [200, 400, 350, 500, 650, 700, 800],
          borderColor: 'rgb(99, 102, 241)',
          backgroundColor: 'rgba(99, 102, 241, 0.2)',
          tension: 0.3,
          fill: true,
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } }
      }
    });
  </script>
</body>
</html>
